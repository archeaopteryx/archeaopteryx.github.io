<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="../css/article-styles.css">
        <link rel="icon" href="images/archeaopteryx-icon.png">
        <title>efaPi: Setup</title>
    </head>

    <body>

    <header>
        <div class="upper-bar">
            <div class="archea-container"><a href="../index.html"><img src="../images/archeaopteryx-1.svg" alt="cartoon drawing of an archaeopteryx working on a laptop" width="150" height="107"/></a></div>
            <div class="title">Archeaopteryx</div>
        </div>
        <div class="menu-bar">
            <a class="skip-main" href="#main">Skip to main content</a>
            <nav class="header-menu">
                <div class="home"><a href='../index.html'>Home</a></div>
                <div class="archive"><a href='../archive.html'>Archive</a></div>
                <div class="about"><a href='../about.html'>About</a></div>
            </nav>
        </div>
    </header>


    <div class='page-inner'>

    <aside class='sidebar'>
        <h2>Contents:</h2>
        <nav>
            <ul class='toc-ul'>
                <li class='toc toc-outer'><a href="#intro">Introduction</a></li>
                <li class='toc toc-outer'><a href="#basics">The basics</a></li>
                <li class='toc toc-outer'><a href="#backups">The backups</a>
                <ul class='toc toc-ul'>
                    <li class='toc toc-inner'><a href="#log-book">The log book</a></li>
                    <li class='toc toc-inner'><a href="#full-backup">Full backup</a></li>
                    <li class='toc toc-inner'><a href="#flags">Using flags</a></li>
                </ul>
                </li>
                <li class='toc toc-outer'><a href='#clean-up'>Cleaning up</a></li>
                <li class='toc toc-outer'><a href='#testing'>Testing</a></li>
                <li class='toc toc-outer'><a href='#conclusions'>Conclusions</a></li>
            </ul>
        </nav>
    </aside>

    <main id="main" tabindex="-1">

    <article>
        <h1 id="intro">EfaPi II: The Cron Job</h1>

        <p>I was emboldend after my success with such tasks as making desktop icons and autolaunching a program, as chronicled in Part I, and felt ready to embark on a quintessential linux-user activity: writing bash scripts to run as a cron job.</p>

        <p class="end-subsection">The goal was to automate local backups of the electronic log book of a rowing club. The software behind the log book is <a href="efa.nmichael.de>"efa</a> (<u>e</u>lektronischer <u>Fa</u>hrtbuch) from N. Michael, which in this case is being run on a raspberry pi.</p>

        <h2 id="basics">The basics</h2>

        <p>Tasks in Linux can be scheduled using the cron utility. A scheduled task, also called a cron job, can be a command or a a program that can be run by a command line interpreter. Such a program is known as a shell script.</p>

        <p>The first line of a shell script is typically a "shebang", a pound symbol directly followed by an exclamation mark (#!), followed by the path the program that should be used to interpret the script. This should be familiar to anyone who has written python scripts. The shebang may look odd, but it's a clever choice. The pound, aka hash, symbol is used for comment lines in many scripting languages. The program loader can pass the script to the interpreter, which then safely ignores this line.</p>

        <p>The commands for making the backup will be written in script files that will be scheduled to run automatically using cron. The scripts will be written in the bash language and saved in files with a .sh extension. To ensure that they will be handled by the correct interpreter, each script starts with a shebang pointing to the location of bash:</p>

        <div class="terminal-box comment-text">
            <pre><code>
  #!/bin/bash
            </code></pre>
        </div>

        <p>The scripts will be saved in the user's bin folder (~/bin), one of the standard locations for scripts. The scripts will also have to be made exutable. Executive rights for the user are added after making the script using chmod: </p>

        <div class="terminal-box">
            <pre><code>
  $ chmod u+x ~/bin/scriptName.sh
            </code></pre>
        </div>

        <p>You can check that the change in permissions was successful using the -l flag with ls.</p>

        <p>Some care should also be taken when naming the script to avoid collisions with existing commands. You can test for collisions with the <code>which</code> command. If the name is already taken, then <code>which</code> returns the path to the existing script. </p>

        <p>Finally, a general warning. Bash can look cryptic, especially if regular expressions get into the mix. But it's really not bad. Don't let the first impression put you off.</p>

        <h2 id="backups">The backups</h2>

        <h3 id="log-book">The log book</h3>

        <h3 id="full-backup">Full backup</h3>

        <h3 id="flags">Using flags</h3>

        <h2 id="clean-up">Cleaning up</h2>

        <h2 id="testing">Testing</h2>

        <h2 id="cron-job">The cron job</h2>

        <h2 id="conclusions">conclusions</h2>


    </article>
    </main>
    </div>

    <footer>
        <small>&copy; Copyright 2020 archeaopteryx.<small>
    </footer>
    </body>
</html>
